01. Install Docker :

https://github.com/mohimenulislam/cka-note/blob/4f6f2781eac352a7fa8a5e39c44671af16c0f72a/CKA/2.%20Docker%20Installation.md

3. Install kubeadm(master,worker), kubelet(master,worker), kubectl(Master)

 - add repo/source list
 - apt-get update
 - apt-get install kubeadm kubelet kubectl
   
5. Initialize the Cluster using Kubeadm init command. (Flanel)
6. export the kubeconfig
04. Verify the Cluster Status
05. Download and apply flannel network plugins
06. verify the status of Cluster
07. add worker nodes

### Installation 

| VMName | Name | IP | GW | DNS |
| --- | ---- | ---- | ---- | ---- | 
k8smaster1 | master1 | 192.168.10.100 | 192.168.10.1 | 8.8.8.8 |
k8sworker1 | worker1 | 192.168.10.101 | 192.168.10.1 | 8.8.8.8 |
k8sworker2 | worker2 | 192.168.10.102 | 192.168.10.1 | 8.8.8.8 |

### k8smaster1:
- hostname: master1
- Docker Engine
- kubeadm + kubectl + kubeadm
  
vi /etc/hosts
```bash
192.168.10.100  master1
192.168.10.101  worker1
192.168.10.102  worker2
```

### worker:
- Docker Engine
- kubeadm
  
vi /etc/hosts
```bash
192.168.10.100  master1
192.168.10.101  worker1
192.168.10.102  worker2
```


#### Swap off

```bash
free -m
swapoff -a

vi /etc/fstab
# make disable swap partition from fstab; use # before line
```

#### Add Repository and install kubeadm kubelet kubectl

dpkg -l | grep kube

```bash
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.34/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg

echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.34/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list
```
Download Link: https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/


```bash
apt-get update
apt-get install kubeadm kubelet kubectl
dpkg -l | grep kube  # check
```

#### Load required modules

```bash
cd /etc/modules-load.d/

# Creat a file namecontainerd.conf

vi /etc/modules-load.d/namecontainerd.conf
  overlay
  br_netfilte

modprobe overlay
modprobe br_netfilter
```
Check
```bash
lsmod | grep overlay
lsmod | grep br_netfilter
```

#### IP forwarding enable

```bash
cd /etc/sysctl.d/
vi 10-k8s.conf

  net.bridge.bridge-nf-call-ip6tables = 1
  net.bridge.bridge-nf-call-iptables = 1
  net.ipv4.ip_forward = 1

sysctl --system
```

Check 
```bash
cat /proc/sys/net/ipv4/ip_forward
```

#### Check Cgroup driver
```bash
docker info | grep -i driver
  Storage Driver: overlay2
 Logging Driver: json-file
 Cgroup Driver: systemd

# if Cgroup Driver: systemd then its ok
```

